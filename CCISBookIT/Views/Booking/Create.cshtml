@model Booking

<form asp-action="Create" method="post">
    <!-- Display validation summary -->
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="form-group">
        <label asp-for="Date"></label>
        <input asp-for="Date" type="date" class="form-control" />
        <span asp-validation-for="Date" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="StartTime"></label>
        <input asp-for="StartTime" type="time" class="form-control" />
        <span asp-validation-for="StartTime" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Duration"></label>
        <input asp-for="Duration" type="number" step="0.1" class="form-control" />
        <span asp-validation-for="Duration" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="EndTime"></label>
        <input asp-for="EndTime" class="form-control" readonly />
    </div>

    <div class="form-group">
        <label asp-for="Purpose"></label>
        <input asp-for="Purpose" class="form-control" />
        <span asp-validation-for="Purpose" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="RoomNo"></label>
        <input asp-for="RoomNo" class="form-control" />
        <span asp-validation-for="RoomNo" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="FacultyID"></label>
        <input asp-for="FacultyID" class="form-control" />
        <span asp-validation-for="FacultyID" class="text-danger"></span>
    </div>

    
    <button type="submit" class="btn btn-primary">Create Booking</button>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        function calculateEndTime() {
            var startTime = document.getElementById("StartTime").value;
            var duration = parseFloat(document.getElementById("Duration").value);

            var startTimeParts = startTime.split(":");
            var startHour = parseInt(startTimeParts[0]);
            var startMinute = parseInt(startTimeParts[1]);
            var startDate = new Date();
            startDate.setHours(startHour, startMinute, 0, 0);

            var endTimeDate = new Date(startDate.getTime() + duration * 60 * 60 * 1000);
            var endHour = endTimeDate.getHours();
            var endMinutes = endTimeDate.getMinutes().toString().padStart(2, "0");
            var period = endHour >= 12 ? 'PM' : 'AM';
            endHour = endHour % 12;
            endHour = endHour ? endHour : 12;

            var endTime = endHour + ':' + endMinutes + ' ' + period;

            document.getElementById("EndTime").value = endTime;
        }

        document.getElementById("StartTime").addEventListener("change", calculateEndTime);
        document.getElementById("Duration").addEventListener("input", calculateEndTime);

        calculateEndTime();
    </script>
}
